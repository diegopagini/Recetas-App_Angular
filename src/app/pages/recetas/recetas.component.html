<div class="container">
  <app-search (emiteReceta)="buscarReceta($event)"></app-search>
</div>

<ng-container
  *ngIf="{
    value: items$ | async
  } as receta"
>
  <ng-container *ngIf="receta.value; else spinner">
    <app-custom-receta [recetas]="recetas"></app-custom-receta>
  </ng-container>
</ng-container>

<mat-divider></mat-divider>

<ng-template #spinner>
  <app-spiner></app-spiner>
</ng-template>

<div class="row title center-align">
  <!-- Modal Trigger -->
  <a
    class="waves-effect waves-light btn modal-trigger btn-custom btn-large"
    href="#modal1"
    id="modal-trigger"
    >Carga tu propia receta</a
  >
</div>

<!-- Modal Structure -->
<div id="modal1" class="modal">
  <div class="modal-content">
    <!-- Form -->
    <form
      [formGroup]="customForm"
      autocomplete="off"
      #form="ngForm"
      (ngSubmit)="onSaveForm(form)"
    >
      <div class="row">
        <div class="col s12 input-field">
          <input formControlName="titulo" type="text" id="titulo" />
          <label for="titulo">Titulo</label>
          <span class="error" *ngIf="tituloInvalid"
            >El titulo es obligatorio.</span
          >
        </div>
      </div>
      <div class="file-field input-field">
        <div class="btn btn-custom">
          <span>Foto</span>
          <input
            formControlName="foto"
            type="file"
            id="file"
            #userPhoto
            title="carga tu foto"
            (change)="onFileSelected($event)"
          />
        </div>
        <div class="file-path-wrapper">
          <input
            class="file-path validate"
            type="text"
            placeholder="Carga una foto de tu receta"
          />
          <span class="error" *ngIf="fotoInvalid">La foto es obligatoria.</span>
        </div>
      </div>
      <div class="row">
        <div class="col s12 input-field">
          <label for="ingredientes text-label">Ingredientes</label>
          <textarea
            class="text-area"
            formControlName="ingredientes"
            type="text-area"
            id="ingredientes"
            cols="10"
            rows="10"
            autocapitalize="sentences"
            wrap="hard"
          ></textarea>
          <span class="error" *ngIf="ingredientesInvalid"
            >Los ingredientes son obligatorios.</span
          >
        </div>
      </div>
      <div class="row">
        <div class="col s12 input-field">
          <label for="preparacion text-label">Preparacion</label>
          <textarea
            class="text-area"
            formControlName="preparacion"
            type="text-area"
            id="preparacion"
          ></textarea>
          <span class="error" *ngIf="preparacionInvalid"
            >La preparaci√≥n es obligatoria.</span
          >
        </div>
      </div>
      <div class="modal-footer">
        <a class="modal-close waves-effect waves-light btn red">Cancelar</a>
        <button
          [disabled]="customForm.invalid"
          type="submit"
          class="waves-effect waves-light btn btn-custom modal-close"
        >
          Enviar
        </button>
      </div>
    </form>
  </div>
</div>
